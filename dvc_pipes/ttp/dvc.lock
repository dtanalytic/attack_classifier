schema: '2.0'
stages:
  feature_generation_ttp:
    cmd: python src/ttp/feat_gen.py dvc_pipes/ttp/params_ttp.yaml
    deps:
    - path: data/interim/prep_df.csv
      hash: md5
      md5: 115e531ae3a4388f502e3e74743eb08b
      size: 28666193
    - path: data/interim/ttp/mlb.pkl
      hash: md5
      md5: 400dd1536fb247aeb574d6292afaf744
      size: 3478
    - path: src/aug_sent.py
      hash: md5
      md5: 6ae89dd51e3a1f9bfc3468ee74174a55
      size: 3244
    - path: src/spec_funcs.py
      hash: md5
      md5: ba6e4fcee652c7e6160bffdb26204e74
      size: 18413
    - path: src/ttp/feat_gen.py
      hash: md5
      md5: 599a4379936ed96c98d0c3999bcdf644
      size: 4596
    params:
      params.yaml:
        seed: 0
      dvc_pipes/ttp/params_ttp.yaml:
        feat_gen_ttp.add_aug_sents: true
        feat_gen_ttp.add_individual_thresh: 0.3
        feat_gen_ttp.aug_emb_path: 
          data/external/models/attack_sent_bert/snapshots/30d285aa0e641ce87a33748a7b3f8f2d8ccfaf42
        feat_gen_ttp.aug_num_mask_pos:
        - 3
        feat_gen_ttp.aug_repeate_mask: 1
        feat_gen_ttp.aug_secbert_path: 
          data/external/models/SecureBERT_Plus/snapshots/4c48ccdb8d2019f179b07dfa27656c655394d78e
        feat_gen_ttp.aug_sim_thresh: 0.95
        feat_gen_ttp.aug_split: tr
        feat_gen_ttp.aug_synth_thresh_class_num: 20
        feat_gen_ttp.aug_topk: 2
        feat_gen_ttp.binary: false
        feat_gen_ttp.feat_strategy: count
        feat_gen_ttp.ind_sel_estim_num: 10
        feat_gen_ttp.ind_sel_tree_max_depth: 3
        feat_gen_ttp.logreg_c: 0.05
        feat_gen_ttp.max_df: 0.05
        feat_gen_ttp.max_features:
        feat_gen_ttp.min_df: 10
        feat_gen_ttp.tree_maxdepth: 3
    outs:
    - path: data/interim/ttp/data_df.csv
      hash: md5
      md5: d50768a3a0a14aa2ef6b4e2b9dd26e15
      size: 58063291
    - path: data/interim/ttp/feat_df.csv
      hash: md5
      md5: 7bbb5d09a28fdbc6c254c52af3f3e54a
      size: 53941317
    - path: data/interim/ttp/vec.pkl
      hash: md5
      md5: 9afe11b7a4781bc451ec3c43709b5b0e
      size: 198687
  feature_engineering_ttp:
    cmd: python src/ttp/feat_eng.py dvc_pipes/ttp/params_ttp.yaml
    deps:
    - path: data/interim/ttp/data_df.csv
      hash: md5
      md5: d50768a3a0a14aa2ef6b4e2b9dd26e15
      size: 58063291
    - path: data/interim/ttp/feat_df.csv
      hash: md5
      md5: 7bbb5d09a28fdbc6c254c52af3f3e54a
      size: 53941317
    - path: data/interim/ttp/vec.pkl
      hash: md5
      md5: 9afe11b7a4781bc451ec3c43709b5b0e
      size: 198687
    - path: src/spec_funcs.py
      hash: md5
      md5: ba6e4fcee652c7e6160bffdb26204e74
      size: 18413
    - path: src/ttp/feat_eng.py
      hash: md5
      md5: c7dfc1cc3d6c337ceda6cd53db7f4b23
      size: 638
    params:
      dvc_pipes/ttp/params_ttp.yaml:
        feat_eng_ttp.add_clust_feat: false
        feat_eng_ttp.add_ind_cols: true
        feat_eng_ttp.add_topic_feat:
        feat_eng_ttp.tfidf_dim:
        feat_eng_ttp.topic_algo: lsa
    outs:
    - path: data/out/ttp/feat_final_df.csv
      hash: md5
      md5: ab0bff773f5007aef5df98ea3df9d6e8
      size: 54075991
  train_eval_model_ttp:
    cmd: python src/ttp/train_eval_model.py dvc_pipes/ttp/params_ttp.yaml
    deps:
    - path: data/out/ttp/feat_final_df.csv
      hash: md5
      md5: ab0bff773f5007aef5df98ea3df9d6e8
      size: 54075991
    - path: src/spec_funcs.py
      hash: md5
      md5: ba6e4fcee652c7e6160bffdb26204e74
      size: 18413
    - path: src/ttp/train_eval_model.py
      hash: md5
      md5: b91b2f6f700d9b43715ef93e26d8564b
      size: 1073
    params:
      params.yaml:
        seed: 0
      dvc_pipes/ttp/params_ttp.yaml:
        train_eval_model_ttp.attack_clf:
        train_eval_model_ttp.balanced:
        train_eval_model_ttp.chain: true
        train_eval_model_ttp.model: logreg
        train_eval_model_ttp.opt_metric: f1
    outs:
    - path: data/out/ttp/by_class_metric.csv
      hash: md5
      md5: b20170ceb27fd3d39a3357f6c045f3f9
      size: 4766
    - path: data/out/ttp/conf_df.csv
      hash: md5
      md5: 3eae1a03142aa12c25856de69a6c15fb
      size: 167426
    - path: data/out/ttp/confusion_matrix.png
      hash: md5
      md5: 673827ebf6d495b326e65ad3f67af5e8
      size: 1093564
    - path: data/out/ttp/confusion_matrix_main_er.png
      hash: md5
      md5: 1eddcf2f9f2919fcc1841ec035e6618b
      size: 161211
    - path: data/out/ttp/m.json
      hash: md5
      md5: 2fa223aa69733365ac66aca417d6d429
      size: 141
    - path: data/out/ttp/m_other.json
      hash: md5
      md5: 6f342132e0b8dc5d532e531538c881ec
      size: 557
    - path: data/out/ttp/model.pkl
      hash: md5
      md5: f2a55b8e3699782db0912c6cf618f130
      size: 1560935
    - path: data/out/ttp/opt_metric.csv
      hash: md5
      md5: 7946c2a437b70a9e4e3276e9f66b9c21
      size: 1888911
