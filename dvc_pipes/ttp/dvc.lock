schema: '2.0'
stages:
  feature_generation_ttp:
    cmd: python src/ttp/feat_gen.py dvc_pipes/ttp/params_ttp.yaml
    deps:
    - path: data/interim/prep_df.csv
      hash: md5
      md5: a88d7e9503c2305092b1f3f15dc41f5c
      size: 22972694
    - path: data/interim/ttp/mlb.pkl
      hash: md5
      md5: df37de6e8b389dcc9282030d7c1edc38
      size: 2230
    - path: src/aug_sent.py
      hash: md5
      md5: 6ae89dd51e3a1f9bfc3468ee74174a55
      size: 3244
    - path: src/spec_funcs.py
      hash: md5
      md5: ba6e4fcee652c7e6160bffdb26204e74
      size: 18413
    - path: src/ttp/feat_gen.py
      hash: md5
      md5: 599a4379936ed96c98d0c3999bcdf644
      size: 4596
    params:
      params.yaml:
        seed: 0
      dvc_pipes/ttp/params_ttp.yaml:
        feat_gen_ttp.add_aug_sents: true
        feat_gen_ttp.add_individual_thresh: 0.3
        feat_gen_ttp.aug_emb_path: 
          data/external/models/attack_sent_bert/snapshots/30d285aa0e641ce87a33748a7b3f8f2d8ccfaf42
        feat_gen_ttp.aug_num_mask_pos:
        - 3
        feat_gen_ttp.aug_repeate_mask: 1
        feat_gen_ttp.aug_secbert_path: 
          data/external/models/SecureBERT_Plus/snapshots/4c48ccdb8d2019f179b07dfa27656c655394d78e
        feat_gen_ttp.aug_sim_thresh: 0.95
        feat_gen_ttp.aug_split: tr
        feat_gen_ttp.aug_synth_thresh_class_num: 20
        feat_gen_ttp.aug_topk: 2
        feat_gen_ttp.binary: false
        feat_gen_ttp.feat_strategy: count
        feat_gen_ttp.ind_sel_estim_num: 10
        feat_gen_ttp.ind_sel_tree_max_depth: 3
        feat_gen_ttp.logreg_c: 0.05
        feat_gen_ttp.max_df: 0.05
        feat_gen_ttp.max_features:
        feat_gen_ttp.min_df: 10
        feat_gen_ttp.tree_maxdepth: 3
    outs:
    - path: data/interim/ttp/data_df.csv
      hash: md5
      md5: 80f8253074c916e632121add3893ea07
      size: 43981944
    - path: data/interim/ttp/feat_df.csv
      hash: md5
      md5: ce9be4679a1158abe654782b2eef543c
      size: 43122638
    - path: data/interim/ttp/vec.pkl
      hash: md5
      md5: f49d91561668e5231f70828e870eed0a
      size: 172715
  feature_engineering_ttp:
    cmd: python src/ttp/feat_eng.py dvc_pipes/ttp/params_ttp.yaml
    deps:
    - path: data/interim/ttp/data_df.csv
      hash: md5
      md5: 80f8253074c916e632121add3893ea07
      size: 43981944
    - path: data/interim/ttp/feat_df.csv
      hash: md5
      md5: ce9be4679a1158abe654782b2eef543c
      size: 43122638
    - path: data/interim/ttp/vec.pkl
      hash: md5
      md5: f49d91561668e5231f70828e870eed0a
      size: 172715
    - path: src/spec_funcs.py
      hash: md5
      md5: ba6e4fcee652c7e6160bffdb26204e74
      size: 18413
    - path: src/ttp/feat_eng.py
      hash: md5
      md5: c7dfc1cc3d6c337ceda6cd53db7f4b23
      size: 638
    params:
      dvc_pipes/ttp/params_ttp.yaml:
        feat_eng_ttp.add_clust_feat: false
        feat_eng_ttp.add_ind_cols: true
        feat_eng_ttp.add_topic_feat:
        feat_eng_ttp.tfidf_dim:
        feat_eng_ttp.topic_algo: lsa
    outs:
    - path: data/out/ttp/feat_final_df.csv
      hash: md5
      md5: 952e9606d632b415cc5ac3dc56538523
      size: 43252908
  train_eval_model_ttp:
    cmd: python src/ttp/train_eval_model.py dvc_pipes/ttp/params_ttp.yaml
    deps:
    - path: data/out/ttp/feat_final_df.csv
      hash: md5
      md5: 952e9606d632b415cc5ac3dc56538523
      size: 43252908
    - path: src/spec_funcs.py
      hash: md5
      md5: ba6e4fcee652c7e6160bffdb26204e74
      size: 18413
    - path: src/ttp/train_eval_model.py
      hash: md5
      md5: b91b2f6f700d9b43715ef93e26d8564b
      size: 1073
    params:
      params.yaml:
        seed: 0
      dvc_pipes/ttp/params_ttp.yaml:
        train_eval_model_ttp.attack_clf:
        train_eval_model_ttp.balanced:
        train_eval_model_ttp.chain: true
        train_eval_model_ttp.model: logreg
        train_eval_model_ttp.opt_metric: f1
    outs:
    - path: data/out/ttp/by_class_metric.csv
      hash: md5
      md5: 00025854a801ea9d0cddd0fb67ac93c5
      size: 3163
    - path: data/out/ttp/conf_df.csv
      hash: md5
      md5: 3c7ecb4059fb1e82dc3a4a6c44292d9f
      size: 132039
    - path: data/out/ttp/confusion_matrix.png
      hash: md5
      md5: d2033993e382dcea89f87e9b054bc990
      size: 568910
    - path: data/out/ttp/confusion_matrix_main_er.png
      hash: md5
      md5: 76f4af855a6b4cbc520274e1dc186729
      size: 120192
    - path: data/out/ttp/m.json
      hash: md5
      md5: 6ea9e39ac355e42e6ab3e6f63aee5bb5
      size: 141
    - path: data/out/ttp/m_other.json
      hash: md5
      md5: cf43986674f1a686b6e2c39fa5c481bb
      size: 559
    - path: data/out/ttp/model.pkl
      hash: md5
      md5: 2a58b623f3c5e25e7295159162afc380
      size: 880887
    - path: data/out/ttp/opt_metric.csv
      hash: md5
      md5: 794b3d2de4f9304ee612d6eb0a86825f
      size: 1414076
