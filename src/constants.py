import re

CLASSES = [
   'T1003.001', 'T1005', 'T1012', 'T1016', 'T1021.001', 'T1027',
   'T1033', 'T1036.005', 'T1041', 'T1047', 'T1053.005', 'T1055',
   'T1056.001', 'T1057', 'T1059.003', 'T1068', 'T1070.004',
   'T1071.001', 'T1072', 'T1074.001', 'T1078', 'T1082', 'T1083',
   'T1090', 'T1095', 'T1105', 'T1106', 'T1110', 'T1112', 'T1113',
   'T1140', 'T1190', 'T1204.002', 'T1210', 'T1218.011', 'T1219',
   'T1484.001', 'T1518.001', 'T1543.003', 'T1547.001', 'T1548.002',
   'T1552.001', 'T1557.001', 'T1562.001', 'T1564.001', 'T1566.001',
   'T1569.002', 'T1570', 'T1573.001', 'T1574.002'
]

# regexp_fpath = re.compile(r'([a-zA-Z]:\\)?(?:[a-zA-Z0-9_-]+\\)*[a-zA-Z0-9_-]+\.[a-zA-Z0-9_]+')

regexp_fpath = re.compile(r'(([a-zA-Z]:[\\\/]+)|([\/]))?(?:[a-zA-Z0-9_-]+[\\\/])*[a-zA-Z0-9_-]+\.[a-zA-Z0-9_]{3,}')
regexp_fname = re.compile(r'[a-zA-Z0-9_-]+\.[a-zA-Z0-9_]{3,}')
regexp_cve = re.compile(r'CVE-\d{4}-\d{4,}')


regexp_ipv4 = re.compile("^((((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(25[0-5]|2[0-4][0-9]|" +
                         "[01]?[0-9][0-9]?))(:\\d+)?)$")

regexp_ipv6 = re.compile("^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|" +
                         "([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}" +
                         "(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|" +
                         "([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}" +
                         "(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|" +
                         ":((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|" +
                         "::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|" +
                         "(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|" +
                         "(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$")

# regexp_domain = re.compile("^((((?=[a-z0-9\\-_]{1,63}\\.)(xn--)?[a-z0-9_\\-]+(-[a-z0-9_]+)*\\.)+" +
#                            "[a-z-0-9]{2,63})(:\\d+)?)$")

regexp_domain = re.compile(r'([a-zA-Z0-9-]+\.){2,}[a-zA-Z]{2,}')

regex_domain_zone = re.compile("\\.(([a-z]+)|(xn--[a-z0-9]+))(:\d+)?$")

regexp_email = re.compile("^((?:[a-z0-9!#\$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#\$%&'*+/=?^_`{|}~-]+)*|" +
                          "\"(?:[\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x21\\x23-\\x5b\\x5d-\\x7f]|\\\\" +
                          "[\\x01-\\x09\\x0b\\x0c\\x0e-\\x7f])*\")@(((?=[a-z0-9\\-_]{1,63}\\.)" +
                          "(xn--)?[a-z0-9_\\-]+(-[a-z0-9_]+)*\\.)+[a-z-0-9]{2,63}))$")

regexp_hash_md5 = re.compile(r"^([a-f0-9]{32})$")
regexp_hash_sha1 = re.compile(r"^([a-f0-9]{40})$")
regexp_hash_sha256 = re.compile(r"^([a-f0-9]{64})$")
regexp_hash_sha512 = re.compile(r"^([a-f0-9]{128})$")
regexp_hash_ssdeep = re.compile(r"^(\d+(:[+/a-zA-Z0-9]{5,})+)$")



regexp_url = re.compile("^((?:(?:(?:https?|ftps?|tcp|udp):)?\\/\\/)(?:\\S+(?::\\S*)?@)?(?:(?!(?:10|127)" +
                        "(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\." +
                        "(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])" +
                        "(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|" +
                        "25[0-4]))|(?:(?:[a-z0-9\\\\u00a1-\\\\uffff][a-z0-9\\\\u00a1-\\\\uffff_-]" +
                        "{0,62})?[a-z0-9\\\\u00a1-\\\\uffff]\\.)+(?:[a-z\\\\u00a1-\\\\uffff]{2,}|" +
                        "xn--[a-z0-9]+\\.?))(?::\\d{2,5})?(?:[/?#]\\S*)?)$")

regexp_registry = re.compile('^((hkey_local_machine|hkey_classes_root|hkey_current_user|hkey_users|hkey_current_config|'
                             'hklm|hlm|hkcr|hcr|hkcu|hcu|hkcc|hcc)[ ]?[/\\][ ]?'
                             '([a-z0-9\s_@\-\^!#.\:\/\$%&+={}\[\]\\* ])+)$')

regexp_coins_eth = re.compile(r'^(0x[a-f0-9]{40})$')
regexp_coins_btc = re.compile(r'^((bc1[a-za-hj-np-z0-9]{35,99})|([3]{1}[a-km-za-hj-np-z1-9]{25,34}))$')
regexp_coins_bch = re.compile(r'^(((bitcoincash|bchreg|bchtest):)?[qp][a-z0-9]{41})$')
regexp_coins_ltc = re.compile(r'^(([lm]{1}[a-km-za-hj-np-z1-9]{25,34})|(ltc1[a-za-hj-np-z0-9]{35,99}))$')
regexp_coins_doge = re.compile(r'^(d[5-9a-hj-np-u]{1}[1-9a-hj-np-za-km-z]{32})$')
regexp_coins_dash = re.compile(r'^(x[1-9a-hj-np-za-km-z]{33})$')
regexp_coins_xmr = re.compile(r'^([84][0-9a-b]{1}[1-9a-hj-np-za-km-z]{93,117})$')
regexp_coins_neo = re.compile(r'^(a[0-9a-z]{33})$')
regexp_coins_xrp = re.compile(r'^(r[0-9a-z]{33})$')